# Amber Infrastructure on GCP

Terraform configuration for deploying Amber to Google Cloud Platform.

## Quick Start

```bash
# Automated setup (recommended)
./setup.sh

# Or manual setup:
# 1. Copy terraform.tfvars.example to terraform.tfvars
# 2. Fill in your GCP project ID and region
# 3. terraform init
# 4. terraform plan
# 5. terraform apply
```

## Services Deployed

- **Cloud Run**: HTTP API service
- **Cloud SQL**: PostgreSQL database
- **Cloud Storage**: Artifact storage
- **Secret Manager**: Secure credential storage

## Deployment

### Automated Deployment

```bash
./deploy.sh
```

This will:
1. Build and push Docker image to Container Registry
2. Apply Terraform configuration
3. Deploy Cloud Run service

### Manual Deployment

1. **Build Docker image:**
   ```bash
   cd ../..
   gcloud builds submit --config=infra/cloudbuild.yaml
   ```

2. **Apply Terraform:**
   ```bash
   terraform apply
   ```

## Configuration

Edit `terraform.tfvars`:
- `project_id`: Your GCP project ID
- `region`: GCP region (default: us-central1)
- `db_password`: Database password (auto-generated by setup.sh)

## Outputs

After deployment:
```bash
terraform output cloud_run_url        # API endpoint
terraform output storage_bucket_name   # Storage bucket
terraform output database_connection_name  # DB connection
```

